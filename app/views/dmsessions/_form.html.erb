<%= form_for(dmsession) do |f| %>
<%= render 'shared/error_messages', :object => f.object %>


  <div class="field">
    <%= f.label :titre %>
    <%= f.text_field :titre %>
  </div>

  <div class="field">
    <%= f.label :date_debut, "Date de début" %>
    <%= f.datetime_select :date_debut %>
  </div>

  <div class="field">
    <%= f.label :date_fin, "Date de fin" %>
    <%= f.datetime_select :date_fin %>
  </div>

  <div class="field">
    <%= f.label :programme_id %>
    <%= f.select :programme_id, Programme.all.collect { |p| [p, "#{p.id}"]} %>
  </div>

  <div class="field">
    <%= f.label :responsable_id %>
    <%= f.select :responsable_id, User.all.collect { |p| [p, "#{p.id}"]} %>
  </div>

  <div class="field">
    <%= f.label :medecin_referent_id, "Médecin référent" %>
    <%= f.select :medecin_referent_id,  User.where(:profil => "médecin référent").collect { |p| [p, "#{p.id}"]} %>
  </div>

  <div class="field">
    <%= f.label :description %>
    <%= f.text_field :description %>
  </div>

  <div class="actions">
    <%= f.submit "Enregistrer" %>
  </div>

    <hr/>

    <% if dmsession.participants.count != 0 %>
        <br/>
        <div class="field">
            <%= f.label "Liste des participants" %><br/>
            <% dmsession.participants.each do |p| %>
                <%= "#{p.user}" %> <%= link_to "(supprimer)", dmsession_participant_path(@dmsession, p.user), :method => :delete, data: {confirm: "Etes-vous certain de supprimer ?"} %><br/>
            <% end %>
        </div>
    <% end %>


<% end %>


<% if !dmsession.id.nil? %>
    <%= form_for dmsession, url: dmsession_participants_path(dmsession), method: :post do |f| %>
        <div class="field">
            <%= f.label "Ajouter un participant" %><br/>
            <%= f.select :participants, User.all.collect {|p| [p, "#{p.id}"]} %>
        </div>
        <div class="actions">
            <%= f.submit "Ajouter" %>
        </div>
    <% end %>
<% end %>


